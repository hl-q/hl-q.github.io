<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang='fr'>
  <head>
    <meta charset='utf-8' />
    <meta content='IE=edge' http-equiv='X-UA-Compatible' />
    <meta content='width=device-width, initial-scale=1' name='viewport' />
    <meta content='Huong-Ly &amp; Quentin' name='description' />
    <meta content='Huong-Ly &amp; Quentin' name='author' />
    <!-- %link{href: "favicon.ico", rel: "shortcut icon"} -->
    <title>Huong-Ly & Quentin</title>
    <link href='/css/bootstrap.min.css' rel='stylesheet' />
    <link href='/css/hl-q.css' rel='stylesheet' />
    <!--[if lt IE 9]>
      <script src='https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js'></script>
      <script src='https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js'></script>
    <![endif]-->
  </head>
  <body role='document'>
    <div class='navbar navbar-default navbar-fixed-top' role='navigation'>
      <div class='container'>
        <div class='navbar-header'>
          <button class='navbar-toggle' data-target='.navbar-collapse' data-toggle='collapse' type='button'>
            <span class='sr-only'>Toggle navigation</span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
          </button>
          <a class='navbar-brand' href='/'>
            <img alt='Huong-Ly &amp; Quentin' class='center-block' src='/img/huong-ly-quentin.png' />
          </a>
        </div>
        <div class='navbar-collapse collapse'>
          <ul class='nav navbar-nav'>
            <li>
              <a href='/fr/reponse'>Réponse</a>
            </li>
            <li>
              <a href='/plus'>Plus</a>
            </li>
            <li>
              <a href='/fr/bientot'>Où dormir ?</a>
            </li>
            <li>
              <a href='/fr/bientot'>Comment venir ?</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class='hlq-spacer-navbar'></div>
    <div class='container' role='main'>
      <div class='hlq-main'>
        <p>
          Un formulaire... Ce n'est pas très convivial, mais ça nous aide pour l'organisation. Si c'est trop embêtant, vous pouvez aussi nous
          <a href='mailto:mariage@hl-q.fr?subject=Reponse'>
            répondre par email
          </a>
          .
        </p>
        <h1>Réponse</h1>
        <div class='hidden' id='hlq-form-wait'>
          <p>Un moment...</p>
        </div>
        <div class='hidden' id='hlq-form-error'>
          <p>Problème de communication avec le serveur...</p>
          <p>
            Réessayez plus tard et/ou
            <a href='mailto:mariage@hl-q.fr?subject=Probleme%20avec%20le%20serveur'>
              envoyez-nous un email.
            </a>
          </p>
        </div>
        <div id='hlq-form-container'>
          <p>Pour répondre à notre invitation, merci de reporter le code en bas à droite de l'intérieur du faire-part:</p>
          <form action='#' class='form-inline' id='hlq-form' onSubmit='return false;' role='form'>
            <label>Code</label>
            <input name='00form-family' type='hidden' value='code' />
            <input name='00lang' type='hidden' value='fr' />
            <input class='form-control' name='00code' placeholder='exemple: A11A1A' type='text' />
            <button class='btn btn-default' onClick='send();'>Envoyer</button>
          </form>
        </div>
      </div>
    </div>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js'></script>
    <script src='/js/bootstrap.min.js'></script>
    <script src='http://mnmc.no-ip.org/mariage?ping=get'></script>
    <script type='text/javascript'>
      //<![CDATA[
        function send() {
            $('#hlq-form-container').addClass('hidden');
            $('#hlq-form-wait').removeClass('hidden');
            $.ajax({
                url: 'http://mnmc.no-ip.org/mariage',
                dataType: 'jsonp',
                data : $('#hlq-form').serialize(),
                timeout: 30000,
                success: function(json){
                    console.log("OK");
                    $('#hlq-form-wait').addClass('hidden');
                    $('#hlq-form-container').removeClass('hidden');
                    $('#hlq-form-container').html(json.html);
                    displayGuestList();
                },
                error: function(jqXHR, textStatus, errorThrown){
                    console.log(textStatus);
                    $('#hlq-form-wait').addClass('hidden');
                    $('#hlq-form-error').removeClass('hidden');
                }
            });
        }
        
        var guestListLength = 1;
        function displayGuestList() {
            if ($('input:radio[name=00reponse]:checked').val() == "yes")
                $('#hlq-guest-list').removeClass('hidden');
            else
                $('#hlq-guest-list').addClass('hidden');
            for (var i = 0; i < guestListLength; i++) {
                $('#hlq-guest'+i).removeClass('hidden');
            }
            for (var i = guestListLength; i < 10; i++) {
                $('#hlq-guest'+i).addClass('hidden');
            }
            if (guestListLength>=10) $('#hlq-guestAdd').addClass('hidden');
        }
        function addGuest() {
            if (guestListLength<10) guestListLength = guestListLength+1;
            displayGuestList();
        }
        displayGuestList();
      //]]>
    </script>
  </body>
</html>
